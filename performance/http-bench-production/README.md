# Http Benchmarking in Production

## Before (install load testing tool) & jade
`npm install -g autocannon`
`npm install -g jade`

## Run
`node server`

## Another tab
`autocannon -c 100 http://localhost:3000/hello`

Should see something like this
100 connections

┌─────────┬──────┬──────┬───────┬──────┬─────────┬────────┬──────────┐
│ Stat    │ 2.5% │ 50%  │ 97.5% │ 99%  │ Avg     │ Stdev  │ Max      │
├─────────┼──────┼──────┼───────┼──────┼─────────┼────────┼──────────┤
│ Latency │ 4 ms │ 4 ms │ 5 ms  │ 9 ms │ 4.17 ms │ 1.3 ms │ 63.02 ms │
└─────────┴──────┴──────┴───────┴──────┴─────────┴────────┴──────────┘
┌───────────┬─────────┬─────────┬─────────┬─────────┬──────────┬─────────┬─────────┐
│ Stat      │ 1%      │ 2.5%    │ 50%     │ 97.5%   │ Avg      │ Stdev   │ Min     │
├───────────┼─────────┼─────────┼─────────┼─────────┼──────────┼─────────┼─────────┤
│ Req/Sec   │ 15479   │ 15479   │ 22447   │ 22751   │ 21646.91 │ 2016.13 │ 15478   │
├───────────┼─────────┼─────────┼─────────┼─────────┼──────────┼─────────┼─────────┤
│ Bytes/Sec │ 6.47 MB │ 6.47 MB │ 9.39 MB │ 9.51 MB │ 9.05 MB  │ 843 kB  │ 6.47 MB │
└───────────┴─────────┴─────────┴─────────┴─────────┴──────────┴─────────┴─────────┘

Req/Bytes counts sampled once per second.

0 2xx responses, 238116 non 2xx responses
238k requests in 11.05s, 99.5 MB read

## Run in production mode
`NODE_ENV=production node server.js`

## Another tab
`autocannon -c 100 http://localhost:3000/hello`

Should see something like this
100 connections

┌─────────┬──────┬──────┬───────┬───────┬─────────┬────────┬──────────┐
│ Stat    │ 2.5% │ 50%  │ 97.5% │ 99%   │ Avg     │ Stdev  │ Max      │
├─────────┼──────┼──────┼───────┼───────┼─────────┼────────┼──────────┤
│ Latency │ 4 ms │ 4 ms │ 6 ms  │ 10 ms │ 4.49 ms │ 1.4 ms │ 77.16 ms │
└─────────┴──────┴──────┴───────┴───────┴─────────┴────────┴──────────┘
┌───────────┬─────────┬─────────┬─────────┬─────────┬──────────┬─────────┬─────────┐
│ Stat      │ 1%      │ 2.5%    │ 50%     │ 97.5%   │ Avg      │ Stdev   │ Min     │
├───────────┼─────────┼─────────┼─────────┼─────────┼──────────┼─────────┼─────────┤
│ Req/Sec   │ 15335   │ 15335   │ 20591   │ 22143   │ 20097.82 │ 1932.96 │ 15333   │
├───────────┼─────────┼─────────┼─────────┼─────────┼──────────┼─────────┼─────────┤
│ Bytes/Sec │ 6.41 MB │ 6.41 MB │ 8.61 MB │ 9.26 MB │ 8.4 MB   │ 807 kB  │ 6.41 MB │
└───────────┴─────────┴─────────┴─────────┴─────────┴──────────┴─────────┴─────────┘

Req/Bytes counts sampled once per second.

0 2xx responses, 221071 non 2xx responses
221k requests in 11.05s, 92.4 MB read
